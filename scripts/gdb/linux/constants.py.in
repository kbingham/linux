/*
 * gdb helper commands and functions for Linux kernel debugging
 *
 *  Kernel constants derived from include files.
 *
 * Copyright (c) 2016 Linaro Ltd
 *
 * Authors:
 *  Kieran Bingham <kieran.bingham@linaro.org>
 *
 * This work is licensed under the terms of the GNU GPL version 2.
 *
 */

#include <asm/page.h>
#include <asm/pgtable.h>
#include <asm/thread_info.h>

#include <linux/fs.h>
#include <linux/swap.h>
#include <linux/mount.h>
#include <linux/vmalloc.h>


/* We need to stringify expanded macros so that they can be parsed */

#define STRING(x) #x
#define XSTRING(x) STRING(x)

/* The build system will take care of deleting everything above this marker */
<!-- end-c-headers -->

import gdb

/* linux/fs.h */
LX_MS_RDONLY = MS_RDONLY
LX_MS_SYNCHRONOUS = MS_SYNCHRONOUS
LX_MS_MANDLOCK = MS_MANDLOCK
LX_MS_DIRSYNC = MS_DIRSYNC
LX_MS_NOATIME = MS_NOATIME
LX_MS_NODIRATIME = MS_NODIRATIME

/* linux/mount.h */
LX_MNT_NOSUID = MNT_NOSUID
LX_MNT_NODEV = MNT_NODEV
LX_MNT_NOEXEC = MNT_NOEXEC
LX_MNT_NOATIME = MNT_NOATIME
LX_MNT_NODIRATIME = MNT_NODIRATIME
LX_MNT_RELATIME = MNT_RELATIME

/* asm/page.h */
LX_PAGE_SHIFT = XSTRING(PAGE_SHIFT)
lx_page_shift = gdb.parse_and_eval(LX_PAGE_SHIFT)

/* asm/thread_info.h */
LX_THREAD_SIZE = XSTRING(THREAD_SIZE)
lx_thread_size = gdb.parse_and_eval(LX_THREAD_SIZE)

/* linux/vmalloc.h */
LX_VMALLOC_TOTAL = XSTRING(VMALLOC_TOTAL)
lx_vmalloc_total = gdb.parse_and_eval(LX_VMALLOC_TOTAL)

/* linux/swap.h */
LX_MAX_SWAPFILES = XSTRING(MAX_SWAPFILES)
lx_max_swapfiles = gdb.parse_and_eval(LX_MAX_SWAPFILES)
